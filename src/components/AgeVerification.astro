---

---

<div
    id="age-verification-popup"
    class="fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50"
>
    <div class="bg-black p-8 rounded-lg text-center max-w-sm mx-4">
        <h2
            class="text-xl md:text-2xl font-bold mb-4 text-palette-2-white-smooth"
        >
            Age Verification
        </h2>
        <div
            class="bg-red-100 border-l-4 border-red-500 text-black p-4 mb-4 text-sm md:text-base"
            role="alert"
        >
            <p class="font-bold">WARNING:</p>
            <p>
                This product contains nicotine. Nicotine is an addictive
                chemical.
            </p>
        </div>
        <p class="mb-6 text-palette-2-white-smooth">
            You must be over 18 years old to enter this site.
        </p>

        <div class="flex justify-center gap-4">
            <button
                id="age-confirm"
                class="bg-white hover:bg-green-300 text-black font-bold py-2 px-4 rounded text-sm md:text-base"
            >
                I am over 18.
            </button>

            <button
                id="age-decline"
                class="bg-white hover:bg-red-400 text-black font-bold py-2 px-4 rounded text-sm md:text-base"
            >
                I am not over 18.
            </button>
        </div>
    </div>
</div>

<script is:inline>
    function handleAgeVerification() {
        const popup = document.getElementById("age-verification-popup");

        // Check cookie
        const isVerified = document.cookie
            .split(";")
            .some((item) => item.trim().startsWith("age_verified="));

        if (isVerified) {
            // If verified, remove the popup if it exists
            if (popup) {
                popup.remove();
            }
            return; // Stop execution
        }

        // If we're here, user is not verified. Make sure popup is visible.
        if (popup) {
            popup.style.display = "flex";

            const confirmButton = document.getElementById("age-confirm");
            const declineButton = document.getElementById("age-decline");

            if (confirmButton) {
                confirmButton.onclick = () => {
                    // Set cookie
                    const date = new Date();
                    date.setTime(date.getTime() + 10 * 60 * 1000);
                    const expires = "expires=" + date.toUTCString();
                    document.cookie =
                        "age_verified=true;" + expires + ";path=/";

                    // Remove popup
                    popup.remove();
                };
            }

            if (declineButton) {
                declineButton.onclick = () => {
                    window.location.href = "about:blank";
                };
            }
        }
    }

    // This event fires on initial page load and after every Astro View Transition.
    document.addEventListener("astro:page-load", handleAgeVerification);
</script>
