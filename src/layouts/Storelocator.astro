---
import { ViewTransitions } from "astro:transitions";
import "@fontsource/poppins/200.css";
import "@fontsource/poppins/300.css";
import "@fontsource/poppins/400.css";
import "@fontsource/poppins/500.css";
import "@fontsource/poppins/600.css";
import "../styles/global.css";
import Navbar from "../components/Nav.astro";
import Footer from "../components/Footer.astro";

export interface Props {
    title: string;
}

const { title } = Astro.props;
---

<!doctype html>
<html lang="en">
    <head>
        <link
            href="https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css"
            rel="stylesheet"
        />
        <meta charset="UTF-8" />
        <meta name="description" content="Astro description" />
        <meta name="viewport" content="width=device-width" />
        <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
        <meta name="generator" content={Astro.generator} />
        <ViewTransitions />
        <title>{title}</title>

        <!-- Leaflet.js CSS for map rendering -->
        <link
            rel="stylesheet"
            href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
            integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
            crossorigin=""
        />
    </head>

    <body
        class="bg-gradient-to-r from-palette-1-dark-green
		 via-palette-1-olive-green to-palette-4-medium-green"
    >
        <nav>
            <Navbar />
        </nav>
        <main>
            <!-- Hero Section -->
            <section
                class="relative h-[300px] flex items-center justify-center"
            >
                <div class="absolute inset-0 backG"></div>
                <h2
                    class="md:text-8xl text-4xl text-shadow-lg font-semibold -tracking-tight text-palette-2-white-smooth z-10"
                >
                    <span
                        class="inline-bloc border border-2px p-2 border-palette-3-light-gray"
                        >Store Location.</span
                    >
                </h2>
            </section>

            <!-- Map and Stores Section -->
            <section
                class="container mx-auto p-4 md:flex md:gap-8 justify-center items-start"
            >
                <div id="map" class="w-full md:w-1/2 lg:w-2/3"></div>
                <div id="stores" class="w-full md:w-1/2 lg:w-1/3 mt-8 md:mt-0">
                </div>
            </section>
        </main>
        <Footer />

        <!-- Leaflet.js script -->
        <script
            is:inline
            src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
            integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
            crossorigin=""></script>

        <!-- Custom script to initialize map and add stores -->
        <script is:inline>
            document.addEventListener("astro:page-load", function () {
                const stores = [
                    {
                        name: "Indio Vape",
                        address:
                            "C. Fausto Cejas Rodriguez, Santo Domingo Este",
                        coords: [18.466353763618255, -69.79801585092338],
                    },
                ];

                const map = L.map("map").setView(stores[0].coords, 13);

                L.tileLayer(
                    "https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",
                    {
                        maxZoom: 19,
                        attribution:
                            '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>',
                    },
                ).addTo(map);

                const storesContainer = document.getElementById("stores");

                stores.forEach((store) => {
                    const marker = L.marker(store.coords).addTo(map);
                    marker.bindPopup(
                        `<b>${store.name}</b><br>${store.address}`,
                    );

                    const storeListing = document.createElement("div");
                    storeListing.className =
                        "p-4 mb-4 bg-palette-1-olive-green rounded-lg shadow-lg";

                    const storeName = document.createElement("h2");
                    storeName.className =
                        "text-2xl font-bold text-palette-2-white-smooth";
                    storeName.textContent = store.name;

                    const storeAddress = document.createElement("p");
                    storeAddress.className = "text-palette-3-light-gray mt-2";
                    storeAddress.textContent = store.address;

                    storeListing.appendChild(storeName);
                    storeListing.appendChild(storeAddress);

                    storesContainer.appendChild(storeListing);
                });
            });
        </script>
    </body>
</html>

<style>
    .backG {
        background-image: linear-gradient(
                to right,
                rgba(0, 0, 0, 0.7),
                rgba(0, 0, 0, 0.7)
            ),
            url(../Images/bg-map.png);
        background-size: cover;
        background-position: center;
        filter: blur(3px);
    }

    #map {
        height: 500px;
        border-radius: 12px;
        box-shadow:
            0 10px 15px -3px rgb(0 0 0 / 0.3),
            0 4px 6px -4px rgb(0 0 0 / 0.3);
        z-index: 1;
    }
</style>
